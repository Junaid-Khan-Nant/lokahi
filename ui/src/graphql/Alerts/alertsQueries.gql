fragment AlertsParts on Query {
  findAllAlerts(
    timeRange: $timeRange
    page: $page
    pageSize: $pageSize
    severities: $severities
    sortAscending: $sortAscending
    sortBy: $sortBy
  ) {
    nextPageToken
    lastPageToken
    totalAlerts
    alerts {
      ackTimeMs
      ackUser
      acknowledged
      clearKey
      counter
      databaseId
      description
      firstEventTimeMs
      lastEventId
      lastUpdateTimeMs
      location
      logMessage
      managedObject {
        instance {
          nodeVal {
            nodeID
          }
        }
        type
      }
      reductionKey
      severity
      tenantId
      type
      uei
    }
  }
}

query Alerts(
  $timeRange: TimeRange!
  $page: Int!
  $pageSize: Int
  $severities: [String]
  $sortAscending: Boolean!
  $sortBy: String
) {
  ...AlertsParts
}

query CountAlerts(
  $timeRange: TimeRange!
  $severityFilters: [String] # ["CRITICAL", "MAJOR"]
) {
  countAlerts(timeRange: $timeRange, severityFilters: $severityFilters)
}
